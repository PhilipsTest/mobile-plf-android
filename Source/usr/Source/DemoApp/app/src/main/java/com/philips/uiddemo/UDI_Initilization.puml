@startuml

Application -> UDIComponent: Init and Launch

UDIComponent -> ServiceDiscovery: To get well-known open-id configuration on country basis
ServiceDiscovery ->UDIComponent : return well-known openId  configuration

UDIComponent -> AuthorizationServer: Prepare Authorization Request
AuthorizationServer ->UDIComponent:success

UDIComponent -> CLP : AuthorizationRequest (performAuthorizationRequest)
CLP --> AuthorizationServer : open in default browser if no, browsers support Custom Tabs
note right: with authorize service configuration, client ID, response-type and redirect-url

AuthorizationServer ->CLP :Authorization Code
CLP ->UDIComponent :Authorization Code

UDIComponent ->AuthorizationServer:request for token end point with auth code
AuthorizationServer -> UDIComponent: success with access token and refresh token


box "IT backend" #LightBlue
participant PIL
participant CLP
end box


box "OpenID Provider" #LightBlue
participant AuthorizationServer
participant JanrainEndpoint
end box

@enduml