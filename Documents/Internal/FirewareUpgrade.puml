@startuml

class App {
}

class Appliance {
    + FirmwarePort getFirmwarePort()
}

class FirmwarePort {
    + uploadFirmware(final byte[] firmwareData)
    + downloadFirmware(String version)
    + abortFirmwareUpload()
    + deployFirmware()
    + getUploadedFirmwareInfo(FirmwareInfoResultCallback callback)
    + addUpdateListener(FirmwareUpdateListener listener)
    + removeUpdateListener(FirmwareUpdateListener listener)
}

interface FirmwareUpdateListener {
    + onStateChange(FirmwarePort port, FirmwareUpdateState state)
    + onProgressUpdate(FirmwarePort port, float progress)
    + onUploadFailed(FirmwarePort port, Result result)
    + onUploadFinished(FirmwarePort port)
    + onDeployFailed(FirmwarePort port, Result result)
    + onDeployFinished(FirmwarePort port)
}

interface DICommPortListener {
    + onPortUpdate(FirmwarePort port)
    + onPortError(FirmwarePort port, Error error, String errorData)
}

abstract class CommunicationStrategy {
    + getProperties()
    + putProperties()
    + subscribe()
    + unsubscribe()
}


class BleCommunicationStrategy {
}
note left : Subscriptions should be\nimplemented with polling

class LanCommunicationStrategy {
}
note right : Subscriptions should be\nimplemented with udp messages


App -down-> Appliance
App ..|> FirmwareUpdateListener : implements
Appliance -down-> FirmwarePort
FirmwarePort .. FirmwareUpdateListener
FirmwarePort .left.> DICommPortListener: has
DICommPortListener -up-> FirmwareUpdateListener
CommunicationStrategy <|-- LanCommunicationStrategy
CommunicationStrategy <|-- BleCommunicationStrategy
FirmwarePort --> CommunicationStrategy

@enduml